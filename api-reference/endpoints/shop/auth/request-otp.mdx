---
title: "Request OTP Code"
api: "POST /{locale}/shop/auth/request-otp"
description: "Send OTP code to user's phone for authentication"
---

# Request OTP Code

Send a one-time password (OTP) to the user's phone number for authentication purposes. The OTP is valid for 5 minutes.

<Info>
This endpoint does not require authentication. It's the first step in the phone-based authentication flow.
</Info>

## Path Parameters

<ParamField path="locale" type="string" required>
  Language code for localized messages (e.g., `en`, `lt`)
</ParamField>

## Request Body

<ParamField body="phone" type="string" required>
  Phone number in international format with `+` prefix
  
  **Format:** `+[country_code][number]` (E.164 format)
  
  **Example:** `+37060000000`
</ParamField>

<ParamField body="type" type="string" required>
  Purpose of the OTP request
  
  **Allowed values:**
  - `login` - For existing user login (user must exist)
  - `register` - For new user registration (user must NOT exist)
  - `verify` - For phone verification
</ParamField>

## Response

<ResponseField name="success" type="boolean">
  Indicates if the OTP was sent successfully
</ResponseField>

<ResponseField name="message" type="string">
  Human-readable status message
</ResponseField>

<ResponseField name="data" type="object">
  <Expandable title="data">
    <ResponseField name="phone" type="string">
      The phone number OTP was sent to
    </ResponseField>
    
    <ResponseField name="expires_at" type="string">
      ISO 8601 timestamp when the OTP expires
    </ResponseField>
  </Expandable>
</ResponseField>

<RequestExample>

```bash cURL
curl -X POST "https://staging-api.loyalty.lt/en/shop/auth/request-otp" \
  -H "Content-Type: application/json" \
  -d '{
    "phone": "+37060000000",
    "type": "login"
  }'
```

```javascript JavaScript
const response = await fetch('https://staging-api.loyalty.lt/en/shop/auth/request-otp', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json'
  },
  body: JSON.stringify({
    phone: '+37060000000',
    type: 'login'
  })
});

const data = await response.json();
console.log(data);
```

```php PHP
<?php
$curl = curl_init();

curl_setopt_array($curl, [
    CURLOPT_URL => 'https://staging-api.loyalty.lt/en/shop/auth/request-otp',
    CURLOPT_RETURNTRANSFER => true,
    CURLOPT_POST => true,
    CURLOPT_HTTPHEADER => ['Content-Type: application/json'],
    CURLOPT_POSTFIELDS => json_encode([
        'phone' => '+37060000000',
        'type' => 'login'
    ])
]);

$response = curl_exec($curl);
curl_close($curl);

print_r(json_decode($response, true));
```

</RequestExample>

<ResponseExample>

```json Success Response (200)
{
  "success": true,
  "message": "OTP sent successfully",
  "data": {
    "phone": "+37060000000",
    "expires_at": "2024-12-08T15:35:00.000Z"
  }
}
```

```json User Not Found (404) - Login type
{
  "success": false,
  "message": "User not found",
  "code": "USER_NOT_FOUND"
}
```

```json User Already Exists (409) - Register type
{
  "success": false,
  "message": "User already exists",
  "code": "USER_EXISTS"
}
```

```json Validation Error (400)
{
  "success": false,
  "message": "Validation failed",
  "code": "VALIDATION_ERROR",
  "errors": {
    "phone": ["The phone format is invalid."],
    "type": ["The selected type is invalid."]
  }
}
```

```json SMS Send Failed (500)
{
  "success": false,
  "message": "Failed to send OTP",
  "code": "SMS_SEND_FAILED"
}
```

</ResponseExample>

## OTP Behavior

<AccordionGroup>
  <Accordion title="OTP Expiration">
    - OTP codes are valid for **5 minutes**
    - After expiration, a new OTP must be requested
    - Expired OTPs cannot be used for login
  </Accordion>
  
  <Accordion title="Rate Limiting">
    - Maximum **3 OTP requests** per phone number per 5 minutes
    - Exceeding this limit results in temporary blocking
    - Wait for cooldown period before retrying
  </Accordion>
  
  <Accordion title="Security">
    - OTP codes are 6-digit numbers
    - Codes are cryptographically generated
    - Maximum **3 verification attempts** per OTP
    - OTP is invalidated after successful use
  </Accordion>
</AccordionGroup>

## Error Codes

| Code | Description | HTTP Status |
|------|-------------|-------------|
| `VALIDATION_ERROR` | Invalid phone format or type | 400 |
| `USER_NOT_FOUND` | No user with this phone (login type) | 404 |
| `USER_EXISTS` | User already exists (register type) | 409 |
| `SMS_SEND_FAILED` | Failed to send SMS | 500 |
| `OTP_REQUEST_ERROR` | Internal error | 500 |

## Next Steps

After receiving the OTP, use one of these endpoints:

<CardGroup cols={2}>
  <Card title="Login with OTP" icon="right-to-bracket" href="/api-reference/endpoints/shop/auth/login">
    Complete login with phone and OTP code
  </Card>
  
  <Card title="Register User" icon="user-plus" href="/api-reference/endpoints/shop/auth/register">
    Register new user with OTP verification
  </Card>
</CardGroup>
