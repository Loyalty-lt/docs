---
title: "Login with OTP"
api: "POST /{locale}/shop/auth/login"
description: "Authenticate user with phone number and OTP code"
---

# Login with OTP

Complete user authentication by providing the phone number and OTP code received via SMS. Returns JWT tokens for API access.

<Info>
This is the second step in the phone-based authentication flow. First, request an OTP using the [Request OTP](/api-reference/endpoints/shop/auth/request-otp) endpoint.
</Info>

## Path Parameters

<ParamField path="locale" type="string" required>
  Language code for localized messages (e.g., `en`, `lt`)
</ParamField>

## Request Body

<ParamField body="phone" type="string" required>
  Phone number in international format (same as used in OTP request)
  
  **Example:** `+37060000000`
</ParamField>

<ParamField body="otp" type="string" required>
  6-digit OTP code received via SMS
  
  **Example:** `123456`
</ParamField>

## Response

<ResponseField name="success" type="boolean">
  Indicates if login was successful
</ResponseField>

<ResponseField name="message" type="string">
  Human-readable status message
</ResponseField>

<ResponseField name="data" type="object">
  <Expandable title="data">
    <ResponseField name="user" type="object">
      <Expandable title="user">
        <ResponseField name="id" type="integer">
          User's unique identifier
        </ResponseField>
        
        <ResponseField name="phone" type="string">
          User's phone number
        </ResponseField>
        
        <ResponseField name="email" type="string">
          User's email address (nullable)
        </ResponseField>
        
        <ResponseField name="name" type="string">
          User's display name
        </ResponseField>
        
        <ResponseField name="email_verified_at" type="string">
          Email verification timestamp (nullable)
        </ResponseField>
        
        <ResponseField name="phone_verified_at" type="string">
          Phone verification timestamp
        </ResponseField>
        
        <ResponseField name="created_at" type="string">
          Account creation timestamp
        </ResponseField>
      </Expandable>
    </ResponseField>
    
    <ResponseField name="token" type="string">
      JWT access token for API requests
    </ResponseField>
    
    <ResponseField name="refresh_token" type="string">
      Refresh token for obtaining new access tokens
    </ResponseField>
    
    <ResponseField name="expires_in" type="integer">
      Token expiration time in seconds (3600 = 1 hour)
    </ResponseField>
  </Expandable>
</ResponseField>

<RequestExample>

```bash cURL
curl -X POST "https://staging-api.loyalty.lt/en/shop/auth/login" \
  -H "Content-Type: application/json" \
  -d '{
    "phone": "+37060000000",
    "otp": "123456"
  }'
```

```javascript JavaScript
const response = await fetch('https://staging-api.loyalty.lt/en/shop/auth/login', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json'
  },
  body: JSON.stringify({
    phone: '+37060000000',
    otp: '123456'
  })
});

const data = await response.json();

if (data.success) {
  // Store tokens securely
  localStorage.setItem('access_token', data.data.token);
  localStorage.setItem('refresh_token', data.data.refresh_token);
  
  console.log('Logged in as:', data.data.user.name);
}
```

```php PHP
<?php
$curl = curl_init();

curl_setopt_array($curl, [
    CURLOPT_URL => 'https://staging-api.loyalty.lt/en/shop/auth/login',
    CURLOPT_RETURNTRANSFER => true,
    CURLOPT_POST => true,
    CURLOPT_HTTPHEADER => ['Content-Type: application/json'],
    CURLOPT_POSTFIELDS => json_encode([
        'phone' => '+37060000000',
        'otp' => '123456'
    ])
]);

$response = curl_exec($curl);
curl_close($curl);

$data = json_decode($response, true);

if ($data['success']) {
    $accessToken = $data['data']['token'];
    $refreshToken = $data['data']['refresh_token'];
    echo "Logged in successfully!";
}
```

</RequestExample>

<ResponseExample>

```json Success Response (200)
{
  "success": true,
  "message": "Login successful",
  "data": {
    "user": {
      "id": 123,
      "phone": "+37060000000",
      "email": "user@example.com",
      "name": "Jonas Jonaitis",
      "email_verified_at": "2024-01-15T10:30:00.000Z",
      "phone_verified_at": "2024-01-01T08:00:00.000Z",
      "created_at": "2024-01-01T08:00:00.000Z"
    },
    "token": "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9...",
    "refresh_token": "a1b2c3d4e5f6g7h8i9j0...",
    "expires_in": 3600
  }
}
```

```json OTP Expired (400)
{
  "success": false,
  "message": "OTP expired or not found",
  "code": "OTP_EXPIRED"
}
```

```json Invalid OTP (400)
{
  "success": false,
  "message": "Invalid OTP code",
  "code": "OTP_INVALID"
}
```

```json Too Many Attempts (429)
{
  "success": false,
  "message": "Too many failed attempts",
  "code": "OTP_MAX_ATTEMPTS"
}
```

```json User Not Found (404)
{
  "success": false,
  "message": "User not found",
  "code": "USER_NOT_FOUND"
}
```

```json Validation Error (400)
{
  "success": false,
  "message": "Validation failed",
  "code": "VALIDATION_ERROR",
  "errors": {
    "phone": ["The phone format is invalid."],
    "otp": ["The otp must be 6 characters."]
  }
}
```

</ResponseExample>

## Using the Access Token

After successful login, include the access token in all authenticated API requests:

```bash
curl -X GET "https://staging-api.loyalty.lt/en/shop/auth/me" \
  -H "Authorization: Bearer YOUR_ACCESS_TOKEN"
```

## Token Management

<AccordionGroup>
  <Accordion title="Access Token">
    - Valid for **1 hour** (3600 seconds)
    - Include in `Authorization: Bearer` header
    - Used for all authenticated API requests
    - Invalidated on logout
  </Accordion>
  
  <Accordion title="Refresh Token">
    - Used to obtain new access tokens
    - Should be stored securely
    - One-time use (new one issued with refresh)
    - Invalidated on logout
  </Accordion>
  
  <Accordion title="OTP Attempts">
    - Maximum **3 failed attempts** per OTP
    - After 3 failures, OTP is invalidated
    - Request a new OTP after exhausting attempts
  </Accordion>
</AccordionGroup>

## Error Codes

| Code | Description | HTTP Status |
|------|-------------|-------------|
| `VALIDATION_ERROR` | Invalid phone or OTP format | 400 |
| `OTP_EXPIRED` | OTP expired or not found | 400 |
| `OTP_INVALID` | Wrong OTP code | 400 |
| `OTP_MAX_ATTEMPTS` | Too many failed attempts | 429 |
| `USER_NOT_FOUND` | User doesn't exist | 404 |
| `LOGIN_ERROR` | Internal login error | 500 |

## Related Endpoints

<CardGroup cols={2}>
  <Card title="Request OTP" icon="message-sms" href="/api-reference/endpoints/shop/auth/request-otp">
    First step: Request OTP code
  </Card>
  
  <Card title="Get Current User" icon="user" href="/api-reference/endpoints/shop/auth/me">
    Get authenticated user profile
  </Card>
  
  <Card title="Refresh Token" icon="rotate" href="/api-reference/endpoints/shop/auth/refresh">
    Refresh expired access token
  </Card>
  
  <Card title="Logout" icon="right-from-bracket" href="/api-reference/endpoints/shop/auth/logout">
    Invalidate tokens and logout
  </Card>
</CardGroup>
